@model ZedCars.Net8.ViewModels.AdminCont.InventoryViewModel

@{
    ViewData["Title"] = "Admin-Inventory";
    string selectedBrand = Model.SelectedBrand as string ?? string.Empty;
}

<div class="container-fluid inventory-page">
    <!-- Page Header -->
    <div class="page-header text-center">
        <h1>Vehicle Inventory Management</h1>
        <p>Manage your vehicle inventory</p>
    </div>

    <!-- Brand Filter + Add Vehicle -->
    <form method="get" class="mb-4">
        <input type="hidden" name="page" value="1" />
        <div class="d-flex gap-2 justify-content-center g-2 align-items-center">
            <div class="col-12 col-md-6 col-lg-4">
                <select name="brand" class="form-select shadow-sm" onchange="this.form.submit()">
                    <option value="">All Brands</option>
                    @if (@Model.Brands is List<string> brands && brands.Any())
                    {
                        foreach (var brand in brands)
                        {
                            if (brand == selectedBrand)
                            {
                                <option value="@brand" selected>@brand</option>
                            }
                            else
                            {
                                <option value="@brand">@brand</option>
                            }
                        }
                    }
                </select>

            </div>
            <div class="col-12 col-md-auto mt-2 mt-md-0">
                <a href="/Admin/AddVehicle" class="btn btn-success w-100">
                    <i class="bi bi-plus-circle"></i> Add New Vehicle
                </a>
            </div>
        </div>
    </form>

    <!-- Inventory Table -->
    @if (Model.Cars.Any())
    {
        <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle text-center">
                <thead class="table-dark">
                    <tr>
                        <th>Image</th>
                        <th>Brand</th>
                        <th>Model</th>
                        <th>Year</th>
                        <th>Price</th>
                        <th>Stock</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var car in Model.Cars)
                    {
                        <tr>
                            <td>
                                <img src="@(!string.IsNullOrEmpty(car.ImageUrl) ? car.ImageUrl : "https://via.placeholder.com/80x60?text=No+Image")"
                                     alt="@car.Make @car.Model"
                                     class="img-fluid rounded shadow-sm"
                                     style="width: 90px; height: 70px; object-fit: cover;" />
                            </td>
                            <td>@car.Make</td>
                            <td>@car.Model</td>
                            <td>@car.Year</td>
                            <td>$@car.Price.ToString("N0")</td>
                            <td>
                                <span class="badge fw-bold px-3 py-2 @(car.StockQuantity > 0 ? "bg-success" : "bg-danger")">
                                    @car.StockQuantity
                                </span>
                            </td>
                            <td>
                                <div class="d-flex justify-content-center gap-2 flex-wrap">
                                    <a href="/Admin/EditVehicle/@car.CarId" class="btn btn-sm btn-primary">
                                        <i class="bi bi-pencil"></i> Edit
                                    </a>
                                    <a href="/Admin/DeleteVehicle/@car.CarId" class="btn btn-sm btn-danger">
                                        <i class="bi bi-trash"></i> Delete
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="no-vehicles mt-4 text-center p-4 rounded shadow-sm">
            <h3>No vehicles available</h3>
            <p>Please add some vehicles to your inventory.</p>
        </div>
    }

    <!-- Pagination -->
    @if (Model.TotalPages > 1)
    {
        <nav aria-label="Inventory pagination" class="mt-4">
            <ul class="pagination justify-content-end">
                <!-- Previous Button -->
                <li class="page-item @(Model.CurrentPage <= 1 ? "disabled" : "")">
                    <a class="page-link" 
                       href="@Url.Action("Inventory", new { brand = Model.SelectedBrand, page = Model.CurrentPage - 1 })"
                       aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <!-- Page Numbers -->
                @for (int i = 1; i <= Model.TotalPages; i++)
                {
                    <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                        <a class="page-link" 
                           href="@Url.Action("Inventory", new { brand = Model.SelectedBrand, page = i })">
                            @i
                        </a>
                    </li>
                }

                <!-- Next Button -->
                <li class="page-item @(Model.CurrentPage >= Model.TotalPages ? "disabled" : "")">
                    <a class="page-link" 
                       href="@Url.Action("Inventory", new { brand = Model.SelectedBrand, page = Model.CurrentPage + 1 })"
                       aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Pagination Info -->
        <div class="text-center text-muted mt-2">
            <small>
                Showing @((Model.CurrentPage - 1) * Model.PageSize + 1) to 
                @(Math.Min(Model.CurrentPage * Model.PageSize, Model.TotalCars)) 
                of @Model.TotalCars vehicles
            </small>
        </div>
    }
</div>

<style>

.inventory-page {
    padding: 30px 15px;
    min-height: 100vh;
    background: #f8f9fa;
}

/* Page Header */
.page-header {
    padding: 30px 15px;
    margin-bottom: 30px;
    border-radius: 12px;
    background: linear-gradient(135deg, #007bff, #00c6ff);
    color: white;
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}

/* Table Styling */
.table-responsive {
    background: white;
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}
.table tbody tr:hover {
    background: #f1f5ff;
    transition: background 0.2s ease-in-out;
}

/* Badge Styling */
.badge {
    font-size: 0.9em;
    border-radius: 20px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

/* Buttons */
.btn { font-weight: 600; font-size: 0.9em; border-radius: 8px; }
.btn-primary { background: #007bff; border: none; }
.btn-primary:hover { background: #0056b3; }
.btn-danger { background: #dc3545; border: none; }
.btn-danger:hover { background: #c82333; }
.btn-success { background: #28a745; border: none; }
.btn-success:hover { background: #218838; }

/* Action Buttons */
.d-flex.gap-2.flex-wrap { gap: 0.5rem; }

/* Empty State */
.no-vehicles {
    background: white;
    color: #6c757d;
}

    .page-item a{
    color: cornflowerblue;
    }

        </style>
